# 第三章 递归

## 3.1 递归

递归与循环：递归是指函数自己调用自己，该方式可以让问题的解决方案更清晰，但并没有性能上的优势。实际中，在有些情况下，使用循环的性能会更好。

## 3.2 基线条件和递归条件

由于递归函数调用自己，因此编写这样的函数时很容易出错，进而导致无限循环。因此，编写递归函数时，必须告诉它何时停止递归。

每个编写正确的递归函数都有两部分，即基线条件和递归条件：

1. 递归条件，指的是函数何时调用自己；
2. 基线条件，指的是函数何时不再调用自己，从而避免形成无限循环。

## 3.3 栈

**栈**：

栈是一种后进先出的数据结构，它通常只有两种操作：压入（插入）和弹出（删除并读取），分别称为入栈和出栈。

**调用栈**：

计算机内部在执行程序时使用称为`调用栈`的栈结构，每当调用一个函数（称为fun1）时，计算机将首先为该函数调用（称为call1）分配一块内存（`栈帧`），并压入调用栈，然后将调用fun1涉及的变量存储在该内存块儿中，当在函数fun1中调用另一个函数（称为fun2）时，计算会为该函数调用（称为call2）也分配一块内存，并压入调用栈，这时call2的内存块逻辑上会位于call1的内存块的上方，成为新的`栈顶`。当对函数fun2调用结束并返回时，call2对应的内存块会被弹出调用栈，程序会继续执行函数fun1的剩余部分，fun1执行完成后，call1对应的内存块也会被弹出调用栈。

上述函数调用过程中，注意一个重要概念：一个函数调用另一个函数时，当前函数将暂停并处于未完成状态，当前函数的所有变量都还保存在该函数对应的内存块（栈帧）中。每个被调用的函数都对应调用栈中的一个栈帧，当前正在执行状态的函数对应于调用栈栈顶的栈帧。

**递归调用栈**：

递归函数执行过程中，也是使用调用栈。每次调用自己都会在调用栈的栈顶创建一个新的栈帧。

使用调用栈虽然很方便，但也要付出代价：存储详尽的信息可能需要占用大量的内存空间，每个函数调用都要占用一定的内存，如果栈很深，就意味着计算机存储了大量函数调用的信息。过多的内存占用，可能会拖慢程序的执行速度，在这种情况下，我们有两种选择：

+ 重新编写代码，转而使用循环代替递归；
+ 使用尾递归，但尾递归并非所有的语言都支持。

## 3.4 小结

+ 递归指的是调用自己的函数。
+ 每个递归函数都有两个条件：基线条件和递归条件。
+ 栈有两种操作：压入和弹出。
+ 所有函数调用都进入调用栈。
+ 调用栈可能很长，这将占用大量的内存。
